# PowerShell Operational Logging & Encoded Command Detection (Windows)

## Overview
This project demonstrates how PowerShell activity can be identified and validated using native Windows logging. The lab focuses on reviewing PowerShell Operational logs in Event Viewer and correlating command execution with logged events. Particular attention is given to encoded PowerShell commands, which are commonly associated with obfuscated or suspicious activity. The objective is to apply SOC-style investigation techniques using built-in Windows tools.

## Objectives
- Verify that PowerShell Operational logging is enabled
- Establish a baseline system timestamp for accurate event correlation
- Execute PowerShell commands, including encoded commands
- Identify PowerShell events generated by command execution
- Document findings using labeled forensic evidence

## Environment
- Host System: macOS
- Virtualization Platform: VMware Fusion
- Guest Operating System: Windows 11 x64
- Tools Used: Windows PowerShell (Administrator), Windows Event Viewer

## Project Structure
powershell-logging-lab/
├── README.md
└── screenshots/
    ├── Screenshot_01_PowerShell_Operational_Log.png
    ├── Screenshot_02_PowerShell_Encoded_Command.png
    ├── Screenshot_03_Event_Logged.png
    ├── Screenshot_04_Baseline_System_Time.png
    ├── Screenshot_05_Operational_Log_Post_Reboot.png
    ├── Screenshot_06_Encoded_Command_Post_Reboot.png
    ├── Screenshot_07_Events_Generated.png
    └── Screenshot_08_Event_Details.png

## Step 1 – Verify PowerShell Operational Logging

Screenshot 01 – PowerShell Operational Logging Enabled  
This screenshot shows the Windows Event Viewer opened to the Microsoft-Windows-PowerShell/Operational log. The presence of numerous PowerShell events confirms that operational logging is enabled and actively capturing PowerShell activity on the system.

## Step 2 – Execute Encoded PowerShell Command

Screenshot 02 – PowerShell Encoded Command Execution  
This screenshot captures the execution of a PowerShell command using the -EncodedCommand parameter. Encoded commands are commonly used to obscure command intent, making them a frequent indicator of suspicious PowerShell usage during security investigations.

## Step 3 – Confirm Event Logging

Screenshot 03 – PowerShell Event Logged in Event Viewer  
This screenshot shows PowerShell activity recorded in the Operational log shortly after command execution. The logged events demonstrate that PowerShell actions are generating detectable artifacts within Windows Event Viewer.

## Step 4 – Establish Baseline System Time

Screenshot 04 – Baseline System Time After VM Reboot  
This screenshot displays the output of the Get-Date command executed after rebooting the virtual machine. Establishing a baseline system time is critical for accurately correlating PowerShell execution with corresponding event log entries.

## Step 5 – Verify Logging After Reboot

Screenshot 05 – PowerShell Operational Log Active After Reboot  
This screenshot confirms that the PowerShell Operational log remains active after the system reboot. New PowerShell events are visible, verifying that logging persisted across the restart and is functioning as expected.

## Step 6 – Execute Encoded Command After Reboot

Screenshot 06 – Encoded PowerShell Command Executed After Reboot  
This screenshot shows the execution of an encoded PowerShell command following the reboot. This step verifies that encoded PowerShell activity continues to generate logs under normal system operation.

## Step 7 – Correlate Encoded Command With Events

Screenshot 07 – PowerShell Events Generated by Encoded Command  
This screenshot highlights multiple PowerShell events generated immediately after the encoded command was executed. The timestamps align with command execution, demonstrating successful correlation between activity and logged events.

## Step 8 – Review Event Details

Screenshot 08 – Event Details Showing PowerShell Execution  
This screenshot displays the detailed event record for a PowerShell Operational log entry. The event details provide structured forensic evidence, including execution context and metadata, which is essential for SOC-level analysis and documentation.

## Key Takeaways
- PowerShell execution generates observable telemetry in Windows Event Viewer
- Encoded PowerShell commands still produce detectable event artifacts
- Timestamp correlation is essential for validating suspicious activity
- Native Windows logging can support basic endpoint investigation workflows

## SOC Relevance
This project reflects common SOC analyst responsibilities such as identifying suspicious PowerShell behavior, correlating system activity with logs, and documenting evidence for further investigation or escalation.

## Screenshots
All screenshots are labeled and stored in the screenshots directory in execution order to support clear documentation and repeatable analysis.

## Next Steps
- Forward PowerShell Operational logs to a SIEM for centralized monitoring
- Develop detection rules for encoded PowerShell execution
- Expand logging coverage using PowerShell Script Block Logging
